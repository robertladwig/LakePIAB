geom_line(data = diff, aes(seq(1, length(diff[,1])), diff[,1], col = 'conv')) +
geom_line(data = conv, aes(seq(1, length(conv[,1])), conv[,1], col = 'final')) +
xlim(0, 700)+ylim(-100,3)
ggplot() +
geom_line(data = initial, aes(seq(1, length(initial[,1])), initial[,1], col = 'heat')) +
geom_line(data = heat, aes(seq(1, length(heat[,1])), heat[,1], col = 'ice')) +
geom_line(data = ice, aes(seq(1, length(ice[,1])), ice[,1], col = 'diff')) +
geom_line(data = diff, aes(seq(1, length(diff[,1])), diff[,1], col = 'conv')) +
geom_line(data = conv, aes(seq(1, length(conv[,1])), conv[,1], col = 'final'))
ggplot() +
geom_line(data = initial, aes(seq(1, length(initial[,1])), initial[,1], col = 'heat')) +
geom_line(data = heat, aes(seq(1, length(heat[,1])), heat[,1], col = 'ice')) +
geom_line(data = ice, aes(seq(1, length(ice[,1])), ice[,1], col = 'diff')) +
geom_line(data = diff, aes(seq(1, length(diff[,1])), diff[,1], col = 'conv')) +
geom_line(data = conv, aes(seq(1, length(conv[,1])), conv[,1], col = 'final')) +
scale_y_continuous(trans = 'log10')
initial <- sqrt((pa1[,2:ncol(pa1)] - si1[,2:ncol(pa1)])**2)
heat <-  sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2)
ice <-  sqrt((pa3[,2:ncol(pa1)] - si3[,2:ncol(pa1)])**2)
diff <-  sqrt((pa4[,2:ncol(pa1)] - si4[,2:ncol(pa1)])**2)
conv <-  sqrt((pa5[,2:ncol(pa1)] - si5[,2:ncol(pa1)])**2)
ggplot() +
geom_line(data = initial, aes(seq(1, length(initial[,1])), initial[,1], col = 'heat')) +
geom_line(data = heat, aes(seq(1, length(heat[,1])), heat[,1], col = 'ice')) +
geom_line(data = ice, aes(seq(1, length(ice[,1])), ice[,1], col = 'diff')) +
geom_line(data = diff, aes(seq(1, length(diff[,1])), diff[,1], col = 'conv')) +
geom_line(data = conv, aes(seq(1, length(conv[,1])), conv[,1], col = 'final')) +
scale_y_continuous(trans = 'log10')
obs <- read.csv("stability/observed.csv")
heat <-  sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2)
ice <-  sqrt((pa3[,2:ncol(pa1)] - si3[,2:ncol(pa1)])**2)
diff <-  sqrt((pa4[,2:ncol(pa1)] - si4[,2:ncol(pa1)])**2)
conv <-  sqrt((pa5[,2:ncol(pa1)] - si5[,2:ncol(pa1)])**2)
heat_p <-  sqrt((pa2[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
ice_p <-  sqrt((pa3[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
diff_p <-  sqrt((pa4[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
conv_p <-  sqrt((pa5[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
heat_s <-  sqrt((si2[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
ice_s <-  sqrt((si3[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
diff_s <-  sqrt((si4[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
conv_s <-  sqrt((si5[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)
heat
datestring <- pa2$time
str(heat)
g_heat <- ggplot() +
geom_line(heat, aes(datestring, X0))
str( sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2))
heat <-  sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2) %>% mutate(time = pa2$time)
str(heat)
heat <-  sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2) %>% mutate(time = as.POSIXct(pa2$time))
str(heat)
heat <-  sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2) %>% mutate(time = as.POSIXct(pa2$time))
ice <-  sqrt((pa3[,2:ncol(pa1)] - si3[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff <-  sqrt((pa4[,2:ncol(pa1)] - si4[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv <-  sqrt((pa5[,2:ncol(pa1)] - si5[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
heat_p <-  sqrt((pa2[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ice_p <-  sqrt((pa3[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff_p <-  sqrt((pa4[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv_p <-  sqrt((pa5[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
heat_s <-  sqrt((si2[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ice_s <-  sqrt((si3[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff_s <-  sqrt((si4[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv_s <-  sqrt((si5[,2:ncol(pa1)] - obs[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
g_heat <- ggplot() +
geom_line(heat, aes(time, X0))
g_heat <- ggplot() +
geom_line(heat, aes(time, "X0"))
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0))
g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0)) +
scale_y_continuous(trans = 'log10') +
scale_colour_manual(values=c('black','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank())
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0)) +
scale_y_continuous(trans = 'log10') +
scale_colour_manual(values=c('black','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0)) +
geom_line(data = heat_p, aes(time, X0)) +
geom_line(data = heat_s, aes(time, X0)) +
scale_y_continuous(trans = 'log10') +
scale_colour_manual(values=c('black','blue', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "expression(Delta)price")) +
geom_line(data = heat_p, aes(time, X0)) +
geom_line(data = heat_s, aes(time, X0)) +
scale_y_continuous(trans = 'log10') +
scale_colour_manual(values=c('black','blue', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
xlab(expression(Delta)Temperature) +
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
xlab(expression(Delta * "Temperature")) +
scale_colour_manual(values=c('black','blue', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression(Delta * "Temperature")) +
xlab("Time step (3600 s)")
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression(Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('black','blue', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('black','blue', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single"))
g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
# geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
# geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_ice <- ggplot() +
geom_line(data =ice_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = ice_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = ice, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after ice step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_ice
g_diff <- ggplot() +
geom_line(data = diff_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = diff_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = diff, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after diffusion (DL) step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_diff
g_heat <- ggplot() +
geom_line(data = conv_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = conv_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after convection step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_ice <- ggplot() +
geom_line(data =ice_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = ice_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = ice, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after ice step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_ice
g_diff <- ggplot() +
geom_line(data = diff_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = diff_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = diff, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after diffusion (DL) step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_diff
g_conv <- ggplot() +
geom_line(data = conv_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = conv_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after convection step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_conv
p9 = g_heat / g_ice / g_diff / g_conv & plot_layout(guides = 'collect') & plot_annotation(tag_levels = 'A')# &theme(legend.position = 'bottom')
ggsave(plot = p9, filename = "figs/Fig7_stability.png", dpi = 300, width = 9, height =12, units = 'in')
1o^1
10^1
10^(-2)
g_heat <- ggplot() +
# geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
# geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','black', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_heat <- ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Observed")) +
# geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_diff <- ggplot() +
geom_line(data = diff_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = diff_s, aes(time, X0,  col = "Single - Observed")) +
# geom_line(data = diff, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after diffusion (DL) step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_diff
g_conv <- ggplot() +
geom_line(data = conv_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = conv_s, aes(time, X0,  col = "Single - Observed")) +
# geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after convection step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_conv
p9 = g_heat / g_ice / g_diff / g_conv & plot_layout(guides = 'collect') & plot_annotation(tag_levels = 'A')# &theme(legend.position = 'bottom')
ggsave(plot = p9, filename = "figs/Fig7_stability.png", dpi = 300, width = 9, height =12, units = 'in')
g_ice <- ggplot() +
geom_line(data =ice_p, aes(time, X0,  col = "Parallel - Observed")) +
geom_line(data = ice_s, aes(time, X0,  col = "Single - Observed")) +
# geom_line(data = ice, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after ice step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_ice
p9 = g_heat / g_ice / g_diff / g_conv & plot_layout(guides = 'collect') & plot_annotation(tag_levels = 'A')# &theme(legend.position = 'bottom')
ggsave(plot = p9, filename = "figs/Fig7_stability.png", dpi = 300, width = 9, height =12, units = 'in')
p9 = g_heat / g_ice / g_diff / g_conv & plot_layout(guides = 'collect')
p9
pb1 <- read.csv("stability/py_temp_initial00.csv")
pb2 <- read.csv("stability/py_temp_heat01.csv")
pb3 <- read.csv("stability/py_temp_total05.csv")
pb4 <- read.csv("stability/py_temp_diff02.csv")
pb5 <- read.csv("stability/py_temp_conv04.csv")
heat <-  sqrt((pa2[,2:ncol(pa1)] - si2[,2:ncol(pa1)])**2) %>% mutate(time = as.POSIXct(pa2$time))
ice <-  sqrt((pa3[,2:ncol(pa1)] - si3[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff <-  sqrt((pa4[,2:ncol(pa1)] - si4[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv <-  sqrt((pa5[,2:ncol(pa1)] - si5[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
heat_p <-  sqrt((pa2[,2:ncol(pa1)] - pb2[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ice_p <-  sqrt((pa3[,2:ncol(pa1)] - pb3[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff_p <-  sqrt((pa4[,2:ncol(pa1)] - pb4[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv_p <-  sqrt((pa5[,2:ncol(pa1)] - pb5[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
heat_s <-  sqrt((si2[,2:ncol(pa1)] - pb2[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ice_s <-  sqrt((si3[,2:ncol(pa1)] - pb3[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff_s <-  sqrt((si4[,2:ncol(pa1)] - pb4[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv_s <-  sqrt((si5[,2:ncol(pa1)] - pb5[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ggplot() +
geom_line(data = heat, aes(seq(1, length(heat[,1])), heat[,1], col = 'ice')) +
geom_line(data = ice, aes(seq(1, length(ice[,1])), ice[,1], col = 'diff')) +
geom_line(data = diff, aes(seq(1, length(diff[,1])), diff[,1], col = 'conv')) +
geom_line(data = conv, aes(seq(1, length(conv[,1])), conv[,1], col = 'final')) +
scale_y_continuous(trans = 'log10')
xlim(0, 700)+ylim(-100,3)
g_heat
g_heat <- ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Process")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Process")) +
# geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
heat_s
ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Process"))
heat_p
pb2
heat_p <-  sqrt((pa2[,2:ncol(pa1)] - pb2[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ice_p <-  sqrt((pa3[,2:ncol(pa1)] - pb3[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff_p <-  sqrt((pa4[,2:ncol(pa1)] - pb4[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv_p <-  sqrt((pa5[,2:ncol(pa1)] - pb5[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
heat_s <-  sqrt((si2[,2:ncol(pa1)] - pb2[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ice_s <-  sqrt((si3[,2:ncol(pa1)] - pb3[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
diff_s <-  sqrt((si4[,2:ncol(pa1)] - pb4[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
conv_s <-  sqrt((si5[,2:ncol(pa1)] - pb5[,2:ncol(pa1)])**2)%>% mutate(time = as.POSIXct(pa2$time))
ggplot() +
geom_line(data = heat, aes(seq(1, length(heat[,1])), heat[,1], col = 'ice')) +
geom_line(data = ice, aes(seq(1, length(ice[,1])), ice[,1], col = 'diff')) +
geom_line(data = diff, aes(seq(1, length(diff[,1])), diff[,1], col = 'conv')) +
geom_line(data = conv, aes(seq(1, length(conv[,1])), conv[,1], col = 'final')) +
scale_y_continuous(trans = 'log10')
xlim(0, 700)+ylim(-100,3)
ice_p
pa2[,2:ncol(pa1)]
pb2[,2:ncol(pa1)]
pa3 == pb3
si2 == pb2
ice_p
diff_p
conv_p
g_diff
g_heat <- ggplot() +
geom_line(data = heat_p, aes(time, X0,  col = "Parallel - Process")) +
geom_line(data = heat_s, aes(time, X0,  col = "Single - Process")) +
# geom_line(data = heat, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after heating step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_heat
g_ice <- ggplot() +
geom_line(data =ice_p, aes(time, X0,  col = "Parallel - Process")) +
geom_line(data = ice_s, aes(time, X0,  col = "Single - Process")) +
# geom_line(data = ice, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after ice step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_ice
g_diff <- ggplot() +
geom_line(data = diff_p, aes(time, X0,  col = "Parallel - Process")) +
geom_line(data = diff_s, aes(time, X0,  col = "Single - Process")) +
# geom_line(data = diff, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after diffusion (DL) step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_diff
g_conv <- ggplot() +
geom_line(data = conv_p, aes(time, X0,  col = "Parallel - Process")) +
geom_line(data = conv_s, aes(time, X0,  col = "Single - Process")) +
# geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after convection step') +
theme_bw() +
theme(legend.title = element_blank()) ; g_conv
p9 = g_heat / g_ice / g_diff / g_conv & plot_layout(guides = 'collect') & plot_annotation(tag_levels = 'A')# &theme(legend.position = 'bottom')
ggsave(plot = p9, filename = "figs/Fig7_stability.png", dpi = 300, width = 9, height =12, units = 'in')
g <- g_conv + xlim(as.POSIXct())
g <-ggplot() +
geom_line(data = conv_p, aes(seq(1,nrow(conv_p)), X0,  col = "Parallel - Process")) +
geom_line(data = conv_s, aes(seq(1,nrow(conv_s)), X0,  col = "Single - Process")) +
# geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after convection step') +
theme_bw() +
theme(legend.title = element_blank()) ; g
g <-ggplot() +
geom_line(data = conv_p, aes(seq(1,nrow(conv_p)), X0,  col = "Parallel - Process")) +
geom_line(data = conv_s, aes(seq(1,nrow(conv_s)), X0,  col = "Single - Process")) +
# geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after convection step') +
xlim(0,1000)+
theme_bw() +
theme(legend.title = element_blank()) ; g
ggsave(plot = g, filename = "figs/Fig8_stability.png", dpi = 300, width = 9, height =12, units = 'in')
ggsave(plot = g, filename = "figs/Fig8_stability.png", dpi = 300, width = 9, height =8, units = 'in')
ggsave(plot = g, filename = "figs/Fig8_stability.png", dpi = 300, width = 9, height =6, units = 'in')
g <-ggplot() +
geom_line(data = conv_p, aes(seq(1,nrow(conv_p)), X0,  col = "Parallel - Process")) +
geom_line(data = conv_s, aes(seq(1,nrow(conv_s)), X0,  col = "Single - Process")) +
geom_point(data = conv_p, aes(seq(1,nrow(conv_p)), X0,  col = "Parallel - Process")) +
geom_point(data = conv_s, aes(seq(1,nrow(conv_s)), X0,  col = "Single - Process")) +
# geom_line(data = conv, aes(time, X0, col = "Parallel - Single")) +
scale_y_continuous(trans = 'log10') +
ylab(expression("log10" *Delta * "Temperature")) +
xlab("Time step (3600 s)") +
scale_colour_manual(values=c('blue','red', 'red')) +
ggtitle('Output after convection step') +
xlim(0,1000)+
theme_bw() +
theme(legend.title = element_blank()) ; g
ggsave(plot = g, filename = "figs/Fig8_stability.png", dpi = 300, width = 9, height =6, units = 'in')
